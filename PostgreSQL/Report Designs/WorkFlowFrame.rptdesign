<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.8.0.v201804241733</property>
    <property name="units">in</property>
    <property name="theme">WFApp_library.WFColors</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="layoutPreference">auto layout</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <list-property name="libraries">
        <structure>
            <property name="fileName">Report Libraries/WFApp_library.rptlibrary</property>
            <property name="namespace">WFApp_library</property>
        </structure>
    </list-property>
    <method name="onContentUpdate"><![CDATA[vwrRptName = this.getViewer().getReportName();

if (window["__first_load"] === undefined) {
    window["__first_load"] = true;

    uiOpts = new actuate.viewer.UIOptions();
    //Remove "Enable Interactivity" menu option
    //uiOpts.enableEditReport(false);
    
    //diable report export menu item
    //uiOpts.enableExportReport(false);
    
    //disable toolbar
    uiOpts.enableToolBar(false);
                
    //disable viewer right-click context menus
    //uiOpts.enableToolbarContextMenu(false);
    
    this.getViewer().setUIOptions(uiOpts);
	
}]]></method>
    <parameters>
        <scalar-parameter name="pReportName" id="716">
            <property name="hidden">false</property>
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">Another.rptdesign</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="pShowComments" id="717">
            <text-property name="promptText">Show Comments and History</text-property>
            <property name="valueType">static</property>
            <property name="dataType">boolean</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">true</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">check-box</property>
            <structure name="format"/>
        </scalar-parameter>
        <scalar-parameter name="pShowEdit" id="718">
            <text-property name="promptText">Show the Editor</text-property>
            <property name="valueType">static</property>
            <property name="dataType">boolean</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant">true</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">check-box</property>
            <structure name="format"/>
        </scalar-parameter>
        <scalar-parameter name="pUpdateStatus" id="730">
            <property name="hidden">false</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="pUpdateComment" id="731">
            <property name="hidden">false</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="pKey" id="739">
            <property name="hidden">false</property>
            <property name="valueType">static</property>
            <property name="isRequired">true</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="javascript">new Date()</value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="pShortComment" id="741">
            <property name="hidden">false</property>
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <script-data-source name="ACL" id="702"/>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Comment Data Source" id="735">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">org.postgresql.Driver</property>
            <property name="odaURL">jdbc:postgresql://ihub-win:8433/workflow</property>
            <property name="odaUser">wfapp</property>
            <property name="odaIsolationMode">serializable</property>
            <encrypted-property name="odaPassword" encryptionID="jce">38bf60bc5cb36729</encrypted-property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <script-data-set name="ACL" id="703">
            <list-property name="resultSetHints">
                <structure>
                    <property name="position">0</property>
                    <property name="name">ACL</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">ACL</property>
                    <property name="analysis">dimension</property>
                </structure>
            </list-property>
            <list-property name="filter">
                <structure>
                    <property name="operator">in</property>
                    <expression name="expr" type="javascript">row["ACL"]</expression>
                    <simple-property-list name="value1">
                        <value>"Approver"</value>
                        <value>"Reviewer"</value>
                    </simple-property-list>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">ACL</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">ACL</property>
            <method name="open"><![CDATA[aclArray = reportContext.getAppContext().get("USER_ACL");
if (aclArray == null)
	aclArray = ["N/A"];
curPos = 0;]]></method>
            <method name="fetch"><![CDATA[if (curPos <= aclArray.length) {
	row["ACL"] = aclArray[curPos++];
	return true;
} else {
	return false;
}]]></method>
        </script-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Comment Data Set" id="736">
            <list-property name="columnHints">
                <structure>
                    <property name="columnName">ID</property>
                    <property name="analysis">measure</property>
                    <text-property name="displayName">ID</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">ID</text-property>
                </structure>
                <structure>
                    <property name="columnName">cKey</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">cKey</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">cKey</text-property>
                </structure>
                <structure>
                    <property name="columnName">Content</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">Content</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">Content</text-property>
                </structure>
                <structure>
                    <property name="columnName">cUser</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">cUser</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">cUser</text-property>
                </structure>
                <structure>
                    <property name="columnName">FullReportName</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">FullReportName</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">FullReportName</text-property>
                </structure>
                <structure>
                    <property name="columnName">Status</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">Status</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">Status</text-property>
                </structure>
                <structure>
                    <property name="columnName">shortContent</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">shortContent</text-property>
                    <text-property name="heading">shortContent</text-property>
                </structure>
                <structure>
                    <property name="columnName">cDate</property>
                    <property name="analysis">dimension</property>
                    <text-property name="displayName">cDate</text-property>
                    <property name="onColumnLayout">false</property>
                    <text-property name="heading">cDate</text-property>
                </structure>
            </list-property>
            <list-property name="filter"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">pReportName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                    <property name="position">1</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">pKey</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                    <property name="position">2</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <list-property name="sortHints">
                <structure>
                    <property name="columnName">dataSetRow["cDate"]</property>
                    <property name="direction">asc</property>
                    <property name="isOptional">true</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">ID</property>
                        <property name="dataType">integer</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">cKey</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">Content</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">cUser</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">FullReportName</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">Status</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">shortContent</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">cDate</property>
                        <property name="dataType">date-time</property>
                    </structure>
                </list-property>
            </structure>
            <property name="needsCache">false</property>
            <method name="beforeOpen"><![CDATA[//this.queryText = this.queryText + " WHERE FullReportName='" + params["pReportName"].value + "';";
reportContext.setPersistentGlobalVariable("status", "");]]></method>
            <method name="onFetch"><![CDATA[if ((row["Status"] != "Comment") &amp;&amp; (row["Status"] != null))  {
	reportContext.setPersistentGlobalVariable("status", row["Status"]);
}
]]></method>
            <property name="dataSource">Comment Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">ID</property>
                    <property name="nativeName">ID</property>
                    <property name="dataType">integer</property>
                    <property name="nativeDataType">4</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">cKey</property>
                    <property name="nativeName">cKey</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">Content</property>
                    <property name="nativeName">Content</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">cUser</property>
                    <property name="nativeName">cUser</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">FullReportName</property>
                    <property name="nativeName">FullReportName</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">Status</property>
                    <property name="nativeName">Status</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">shortContent</property>
                    <property name="nativeName">shortContent</property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">12</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">cDate</property>
                    <property name="nativeName">cDate</property>
                    <property name="dataType">date-time</property>
                    <property name="nativeDataType">93</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select *
from comments
where "FullReportName"=?
and "cKey"=?]]></xml-property>
            <xml-property name="designerValues"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<model:DesignValues xmlns:design="http://www.eclipse.org/datatools/connectivity/oda/design" xmlns:model="http://www.eclipse.org/birt/report/model/adapter/odaModel">
  <Version>2.0</Version>
  <design:ResultSets derivedMetaData="true">
    <design:resultSetDefinitions>
      <design:resultSetColumns>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>ID</design:name>
              <design:position>1</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>4</design:nativeDataTypeCode>
            <design:precision>10</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>ID</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>ID</design:label>
            <design:formattingHints>
              <design:displaySize>10</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>cKey</design:name>
              <design:position>2</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>50</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>cKey</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>cKey</design:label>
            <design:formattingHints>
              <design:displaySize>50</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>Content</design:name>
              <design:position>3</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>16777215</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>Content</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>Content</design:label>
            <design:formattingHints>
              <design:displaySize>16777215</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>cDate</design:name>
              <design:position>4</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>93</design:nativeDataTypeCode>
            <design:precision>19</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>cDate</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>cDate</design:label>
            <design:formattingHints>
              <design:displaySize>19</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>cUser</design:name>
              <design:position>5</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>45</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>cUser</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>cUser</design:label>
            <design:formattingHints>
              <design:displaySize>45</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>FullReportName</design:name>
              <design:position>6</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>254</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>NotNullable</design:nullability>
            <design:uiHints>
              <design:displayName>FullReportName</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>FullReportName</design:label>
            <design:formattingHints>
              <design:displaySize>254</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
        <design:resultColumnDefinitions>
          <design:attributes>
            <design:identifier>
              <design:name>Status</design:name>
              <design:position>7</design:position>
            </design:identifier>
            <design:nativeDataTypeCode>12</design:nativeDataTypeCode>
            <design:precision>45</design:precision>
            <design:scale>0</design:scale>
            <design:nullability>Nullable</design:nullability>
            <design:uiHints>
              <design:displayName>Status</design:displayName>
            </design:uiHints>
          </design:attributes>
          <design:usageHints>
            <design:label>Status</design:label>
            <design:formattingHints>
              <design:displaySize>45</design:displaySize>
            </design:formattingHints>
          </design:usageHints>
        </design:resultColumnDefinitions>
      </design:resultSetColumns>
      <design:criteria/>
    </design:resultSetDefinitions>
  </design:ResultSets>
</model:DesignValues>]]></xml-property>
        </oda-data-set>
    </data-sets>
    <styles>
        <style name="report" id="4">
            <property name="fontFamily">sans-serif</property>
            <property name="fontSize">10pt</property>
        </style>
        <style name="crosstab-cell" id="5">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
        <style name="crosstab" id="6">
            <property name="borderBottomColor">#CCCCCC</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">1pt</property>
            <property name="borderLeftColor">#CCCCCC</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">1pt</property>
            <property name="borderRightColor">#CCCCCC</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">1pt</property>
            <property name="borderTopColor">#CCCCCC</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">1pt</property>
        </style>
    </styles>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2"/>
    </page-setup>
    <body>
        <extended-item extensionName="SqlWriteback" id="737">
            <property name="dataSource">Comment Data Source</property>
            <property name="itemOutput">Added $cnt record(s).</property>
            <expression name="sqlStatement" type="javascript">if ((params["pUpdateStatus"].value != "") &amp;&amp; (params["pKey"] != "")) {&#13;
		"INSERT INTO comments (\"cKey\",\"Content\",\"cDate\",\"cUser\",\"FullReportName\",\"Status\", \"shortContent\") VALUES (\'" + params["pKey"].value + "\',\'" + params["pUpdateComment"].value + "\',\'" + Formatter.format(BirtDateTime.now(),"yyyy-MM-dd HH:mm:ss") + "\',\'" + reportContext.getAppContext().get("ServerUserName") + "\',\'" + params["pReportName"] .value+ "\', \'" + params["pUpdateStatus"].value + "\', \'" +  params["pShortComment"].value.replace(/'/g,"''") + "\')";&#13;
	}</expression>
            <list-property name="visibility">
                <structure>
                    <property name="format">all</property>
                    <expression name="valueExpr" type="javascript">true</expression>
                </structure>
            </list-property>
        </extended-item>
        <grid id="601">
            <list-property name="userProperties">
                <structure>
                    <property name="name">userpropKey</property>
                    <property name="type">string</property>
                </structure>
            </list-property>
            <property name="userpropKey">PLChart</property>
            <property name="borderBottomStyle">solid</property>
            <property name="borderBottomWidth">medium</property>
            <property name="borderLeftStyle">solid</property>
            <property name="borderLeftWidth">medium</property>
            <property name="borderRightStyle">solid</property>
            <property name="borderRightWidth">medium</property>
            <property name="borderTopStyle">solid</property>
            <property name="borderTopWidth">medium</property>
            <property name="marginLeft">10pt</property>
            <property name="width">10.447916666666666in</property>
            <column id="602">
                <property name="width">9.916666666666666in</property>
            </column>
            <column id="603">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">true</expression>
                    </structure>
                </list-property>
                <property name="width">0.53125in</property>
            </column>
            <row id="604">
                <cell id="605">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <text id="740">
                        <property name="contentType">html</property>
                        <text-property name="content"><![CDATA[<script>
	//Set global variable for HTML Buttons to use
	pReportName = "<VALUE-OF>params["pReportName"].value</VALUE-OF>";
	pKey = "<VALUE-OF>params["pKey"].value</VALUE-OF>";
	
	function insertComment(vwrRptName, Status, Comment, shortComment) {
		var url = "/iportal/executereport.do?__executableName=";
		url = url + encodeURIComponent(vwrRptName);
		url = url + "&amp;pReportName=" + encodeURIComponent(pReportName);
		url = url + "&amp;pKey=" + encodeURIComponent(pKey);
		url = url + "&amp;invokesubmit=true&amp;__wait=wait&amp;__requestType=immediate"; 
		url = url + "&amp;pUpdateStatus=" + Status;
		url = url + "&amp;pShortComment=" + encodeURIComponent(shortComment);
		url = url + "&amp;pUpdateComment=" + encodeURIComponent(Comment);
		location.href = url;
	}
	
	function shortenComment(objEditor, content) {
//		var c1 = content.replace(/<br \/>/g, "&amp;nbsp;<br />"); //add a space before BR for short Text
//		c1 = c1.replace(/<p>/g, "&amp;nbsp;<p>");  //add a space before P for short text
//		objEditor.setData(c1); //put spaced content back into editor
//		var txtC = $("#cke_editor1 iframe").contents().find("body").text(); 
var txtC = objEditor.document.getBody().getText();
//get content without HTML tags
		if (txtC.length > 49) {  //longer than 50 add ...
			txtC = txtC.substring(0,49);
			txtC = txtC + " ...";
		}	
		return txtC;
	}

</script>]]></text-property>
                    </text>
                    <text id="715">
                        <property name="contentType">html</property>
                        <text-property name="content"><![CDATA[<script>	
	//Open report to be viewed inside a "frame"
	var rpt = "<VALUE-OF>params["pReportName"].value</VALUE-OF>";
	var rptExt = rpt.split('.').pop().toLowerCase();
	var rptName = rpt.replace(/^.*[\\\/]/, '');
	switch (rptExt) {
		case "gadget":
		case "dashboard":
			document.getElementById("acViewer").innerHTML = "<iframe width='1000px' height='750px' src='/iportal/dashboard?conf=" + encodeURIComponent(rpt) + "&amp;__launchDesigner=false' /iframe>";
			break;			
			
		case "rptdesign":
		case "rptdocument":
			var panel = new actuate.viewer.BrowserPanel();
			uiCfg = new actuate.viewer.UIConfig();
			uiCfg.setContentPanel(panel);
			var vwr = new actuate.Viewer("acViewer", uiCfg);
			vwr.setWidth(1000);
			vwr.setHeight(750);
			vwr.setReportName(rpt);
			vwr.submit();
			break;
		
		case "docx":
		case "xlsx":
		case "pptx":
			document.getElementById("acViewer").innerHTML = "<div><p><strong> The file has been downloaded, use the file type's native application to view it.</stong></p></div><iframe width='1000px' height='1px' border='0px' src='/iportal/servlet/DownloadFile/" + rptName + "?name=" + encodeURIComponent(rpt) + "&amp;fileExtension=" + rptExt + "&amp;__vp=Default%20Volume&amp;volume=Default%20Volume&amp;showBanner=false' /iframe>";			
			break;
			
		default:
			document.getElementById("acViewer").innerHTML = "<iframe width='1000px' height='750px' src='/iportal/servlet/DownloadFile/" + rptName + "?name=" + encodeURIComponent(rpt) + "&amp;fileExtension=" + rptExt + "&amp;__vp=Default%20Volume&amp;volume=Default%20Volume&amp;showBanner=false' /iframe>";
	}
	
	
	$(".reporttitle_text")[1].innerHTML = "<VALUE-OF>params["pReportName"].value</VALUE-OF>";
		
	document.title = "Work Flow Item";
</script>

<div id="acViewer" style="overflow-y:auto;"></div>]]></text-property>
                    </text>
                </cell>
            </row>
            <row id="607">
                <property name="borderTopStyle">solid</property>
                <property name="borderTopWidth">medium</property>
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">params["pShowComments"].value==false</expression>
                    </structure>
                </list-property>
                <cell id="608">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <table id="657">
                        <property name="width">10.375in</property>
                        <property name="dataSet">Comment Data Set</property>
                        <property name="theme">WFApp_library.Modern Table</property>
                        <list-property name="visibility">
                            <structure>
                                <property name="format">all</property>
                                <expression name="valueExpr" type="javascript">params["pShowComments"].value==false</expression>
                            </structure>
                        </list-property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">Content</property>
                                <text-property name="displayName">Content</text-property>
                                <expression name="expression" type="javascript">dataSetRow["Content"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">cDate</property>
                                <text-property name="displayName">cDate</text-property>
                                <expression name="expression" type="javascript">dataSetRow["cDate"]</expression>
                                <property name="dataType">date-time</property>
                            </structure>
                            <structure>
                                <property name="name">cUser</property>
                                <text-property name="displayName">cUser</text-property>
                                <expression name="expression" type="javascript">dataSetRow["cUser"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">Status</property>
                                <text-property name="displayName">Status</text-property>
                                <expression name="expression" type="javascript">dataSetRow["Status"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <list-property name="sort">
                            <structure>
                                <expression name="key" type="javascript">row["cDate"]</expression>
                                <property name="direction">desc</property>
                                <property name="strength">0</property>
                            </structure>
                        </list-property>
                        <column id="681">
                            <property name="width">1.7083333333333333in</property>
                        </column>
                        <column id="682">
                            <property name="width">1.3125in</property>
                        </column>
                        <column id="683">
                            <property name="width">1.6666666666666667in</property>
                        </column>
                        <column id="684">
                            <property name="width">5.6875in</property>
                        </column>
                        <header>
                            <row id="685">
                                <property name="backgroundColor">white</property>
                                <property name="color">gray</property>
                                <cell id="686">
                                    <property name="backgroundColor">white</property>
                                    <label name="NewLabel11" id="690">
                                        <property name="fontWeight">bold</property>
                                        <property name="fontStyle">italic</property>
                                        <property name="color">gray</property>
                                        <property name="textAlign">left</property>
                                        <text-property name="text">History:</text-property>
                                    </label>
                                </cell>
                                <cell id="687">
                                    <property name="backgroundColor">white</property>
                                </cell>
                                <cell id="688">
                                    <property name="backgroundColor">white</property>
                                </cell>
                                <cell id="689">
                                    <property name="backgroundColor">white</property>
                                </cell>
                            </row>
                            <row id="658">
                                <cell id="659">
                                    <property name="paddingLeft">10pt</property>
                                    <label id="662">
                                        <property name="fontWeight">bold</property>
                                        <property name="textUnderline">underline</property>
                                        <property name="textAlign">left</property>
                                        <text-property name="text">Date</text-property>
                                    </label>
                                </cell>
                                <cell id="661">
                                    <label id="664">
                                        <property name="fontWeight">bold</property>
                                        <property name="textUnderline">underline</property>
                                        <property name="textAlign">left</property>
                                        <text-property name="text">User</text-property>
                                    </label>
                                </cell>
                                <cell id="663">
                                    <label id="666">
                                        <property name="fontWeight">bold</property>
                                        <property name="textUnderline">underline</property>
                                        <property name="textAlign">left</property>
                                        <text-property name="text">Status</text-property>
                                    </label>
                                </cell>
                                <cell id="665">
                                    <label id="660">
                                        <property name="fontWeight">bold</property>
                                        <property name="textUnderline">underline</property>
                                        <property name="textAlign">left</property>
                                        <text-property name="text">Comment</text-property>
                                    </label>
                                </cell>
                            </row>
                        </header>
                        <detail>
                            <row id="667">
                                <property name="verticalAlign">top</property>
                                <cell id="668">
                                    <property name="paddingLeft">10pt</property>
                                    <data id="671">
                                        <property name="paddingTop">2pt</property>
                                        <property name="paddingBottom">2pt</property>
                                        <property name="resultSetColumn">cDate</property>
                                    </data>
                                </cell>
                                <cell id="670">
                                    <data id="673">
                                        <property name="paddingTop">2pt</property>
                                        <property name="paddingBottom">2pt</property>
                                        <property name="resultSetColumn">cUser</property>
                                    </data>
                                </cell>
                                <cell id="672">
                                    <list-property name="highlightRules">
                                        <structure>
                                            <property name="operator">eq</property>
                                            <expression name="testExpr" type="javascript">row["Status"]</expression>
                                            <simple-property-list name="value1">
                                                <value type="javascript">"Submitted for Review"</value>
                                            </simple-property-list>
                                            <property name="style">SubmittedForReview</property>
                                        </structure>
                                        <structure>
                                            <property name="operator">eq</property>
                                            <expression name="testExpr" type="javascript">row["Status"]</expression>
                                            <simple-property-list name="value1">
                                                <value type="javascript">"To Be Approved"</value>
                                            </simple-property-list>
                                            <property name="style">SubmitForApproval</property>
                                        </structure>
                                        <structure>
                                            <property name="operator">eq</property>
                                            <expression name="testExpr" type="javascript">row["Status"]</expression>
                                            <simple-property-list name="value1">
                                                <value type="javascript">"Approved"</value>
                                            </simple-property-list>
                                            <property name="style">Approve</property>
                                        </structure>
                                        <structure>
                                            <property name="operator">eq</property>
                                            <expression name="testExpr" type="javascript">row["Status"]</expression>
                                            <simple-property-list name="value1">
                                                <value type="javascript">"Rejected"</value>
                                            </simple-property-list>
                                            <property name="style">Reject</property>
                                        </structure>
                                    </list-property>
                                    <data id="675">
                                        <property name="paddingTop">2pt</property>
                                        <property name="paddingLeft">2pt</property>
                                        <property name="paddingBottom">2pt</property>
                                        <property name="display">block</property>
                                        <property name="resultSetColumn">Status</property>
                                    </data>
                                </cell>
                                <cell id="674">
                                    <text id="701">
                                        <property name="paddingTop">2pt</property>
                                        <property name="paddingBottom">2pt</property>
                                        <property name="contentType">html</property>
                                        <text-property name="content"><![CDATA[<VALUE-OF format="HTML">row["Content"]</VALUE-OF>]]></text-property>
                                    </text>
                                </cell>
                            </row>
                        </detail>
                    </table>
                </cell>
            </row>
            <row id="694">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">params["pShowEdit"].value==false</expression>
                    </structure>
                </list-property>
                <cell id="695">
                    <label id="697">
                        <expression name="bookmark" type="javascript">"Spacer"</expression>
                    </label>
                </cell>
                <cell id="696">
                    <table id="704">
                        <property name="dataSet">ACL</property>
                        <list-property name="visibility">
                            <structure>
                                <property name="format">all</property>
                                <expression name="valueExpr" type="javascript">true</expression>
                            </structure>
                        </list-property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">ACL</property>
                                <text-property name="displayName">ACL</text-property>
                                <expression name="expression" type="javascript">dataSetRow["ACL"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                        </list-property>
                        <method name="onPrepare"><![CDATA[reportContext.setPersistentGlobalVariable("Role","");]]></method>
                        <column id="713"/>
                        <header>
                            <row id="705">
                                <cell id="706">
                                    <label id="707">
                                        <text-property name="text">ACL</text-property>
                                    </label>
                                </cell>
                            </row>
                        </header>
                        <detail>
                            <row id="708">
                                <method name="onCreate"><![CDATA[reportContext.setPersistentGlobalVariable("Role", row["ACL"] );]]></method>
                                <cell id="709">
                                    <data id="710">
                                        <property name="resultSetColumn">ACL</property>
                                    </data>
                                </cell>
                            </row>
                        </detail>
                    </table>
                </cell>
            </row>
            <row id="610">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">params["pShowEdit"].value==false</expression>
                    </structure>
                </list-property>
                <cell id="611">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <extended-item extensionName="HTMLButton" name="btnSaveComment" id="725">
                        <method name="clientScripts"><![CDATA[
/**
 * Occurs when mouse clicks.
 * @param event
 */

this.onclick = function(event)
{ 
	var c = CKEDITOR.instances.editor1.getData();  //get editor content
	if (c == '') {
		alert("Please enter a comment.");
	}
	else { 
		var txtC = shortenComment(CKEDITOR.instances.editor1, c);
		insertComment(this.getViewer().getReportName(), "Comment", c, txtC);
	}
}
]]></method>
                        <expression name="text" type="constant">Save Comment Only</expression>
                        <property name="display">inline</property>
                        <expression name="bookmark" type="javascript">"CommentButton"</expression>
                        <property name="style">Comment</property>
                    </extended-item>
                    <extended-item extensionName="HTMLButton" name="btnApprove" id="726">
                        <method name="clientScripts"><![CDATA[
/**
 * Occurs when mouse clicks.
 * @param event
 */

this.onclick = function(event)
{ 
	var c = CKEDITOR.instances.editor1.getData();
	if (c == '') {
		alert("Please enter a comment.");
	}
	else {
		var txtC = shortenComment(CKEDITOR.instances.editor1, c);
		insertComment(this.getViewer().getReportName(), "Approved", c, txtC);
	}
}
]]></method>
                        <expression name="text" type="constant">Approve</expression>
                        <property name="display">inline</property>
                        <expression name="bookmark" type="javascript">"ApproveButton"</expression>
                        <list-property name="visibility">
                            <structure>
                                <property name="format">all</property>
                                <expression name="valueExpr" type="javascript">if ((reportContext.getPersistentGlobalVariable("status")=="To Be Approved") &amp;&amp; (reportContext.getPersistentGlobalVariable("Role")=="Approver"))&#13;
	false;&#13;
else&#13;
	true;</expression>
                            </structure>
                        </list-property>
                        <property name="style">Approve</property>
                    </extended-item>
                    <extended-item extensionName="HTMLButton" name="btnReject" id="727">
                        <method name="clientScripts"><![CDATA[
/**
 * Occurs when mouse clicks.
 * @param event
 */

this.onclick = function(event)
{ 
	var c = CKEDITOR.instances.editor1.getData();
	if (c == '') {
		alert("Please enter a comment.");
	}
	else {
		var txtC = shortenComment(CKEDITOR.instances.editor1, c);
		insertComment(this.getViewer().getReportName(), "Rejected", c, txtC);
	}
}
]]></method>
                        <expression name="text" type="constant">Reject</expression>
                        <property name="display">inline</property>
                        <expression name="bookmark" type="javascript">"RejectButton"</expression>
                        <list-property name="visibility">
                            <structure>
                                <property name="format">all</property>
                                <expression name="valueExpr" type="javascript">if ((reportContext.getPersistentGlobalVariable("status")=="To Be Approved") &amp;&amp; (reportContext.getPersistentGlobalVariable("Role")=="Approver"))&#13;
	false;&#13;
else&#13;
	true;</expression>
                            </structure>
                        </list-property>
                        <property name="style">Reject</property>
                    </extended-item>
                    <extended-item extensionName="HTMLButton" name="btnToBeApproved" id="728">
                        <method name="clientScripts"><![CDATA[
/**
 * Occurs when mouse clicks.
 * @param event
 */

this.onclick = function(event)
{ 
	var c = CKEDITOR.instances.editor1.getData();
	if (c == '') {
		alert("Please enter a comment.");
	}
	else {
		var txtC = shortenComment(CKEDITOR.instances.editor1, c);
		insertComment(this.getViewer().getReportName(), "To Be Approved", c, txtC);
	}
}
]]></method>
                        <expression name="text" type="constant">Submit for Approval</expression>
                        <property name="backgroundImageType">url</property>
                        <property name="backgroundRepeat">repeat</property>
                        <property name="display">inline</property>
                        <expression name="bookmark" type="javascript">"SubmitReviewButton"</expression>
                        <list-property name="visibility">
                            <structure>
                                <property name="format">all</property>
                                <expression name="valueExpr" type="javascript">if (((reportContext.getPersistentGlobalVariable("status")=="Submitted for Review") || (reportContext.getPersistentGlobalVariable("status")=="Rejected")) &amp;&amp; (reportContext.getPersistentGlobalVariable("Role")=="Reviewer"))&#13;
	false;&#13;
else&#13;
	true;</expression>
                            </structure>
                        </list-property>
                        <property name="style">SubmitForApproval</property>
                    </extended-item>
                    <text id="742">
                        <property name="contentType">html</property>
                        <text-property name="content"><![CDATA[<script>
//This is a workaround for button backgrounds not working in iHub 3.1

//	$(document).ready(function() {
		$("[id$='SubmitReviewButton']").children("button").css("background-color", "#FFDB5E");
	});
	
//	$(document).ready(function() {
		$("[id$='CommentButton']").children("button").css("background-color", "white");
	});
	
//	$(document).ready(function() {
		$("[id$='RejectButton']").children("button").css("background-color", "red");
	});
	
//	$(document).ready(function() {
		$("[id$='ApproveButton']").children("button").css("background-color", "green");
	});
</script>]]></text-property>
                    </text>
                    <text id="723">
                        <property name="contentType">html</property>
                        <text-property name="content"><![CDATA[<script>
      var ck=document.createElement('script');
      ck.setAttribute("type","text/javascript");
      
      ck.setAttribute("src", "/iportal/ckeditor/ckeditor.js");
      document.getElementsByTagName("head")[0].appendChild(ck);

</script>

<p>Welcome <b><VALUE-OF>reportContext.getAppContext().get("ServerUserName")</VALUE-OF></b>, you may enter your comments below.</p>

<textarea class="ckeditor" id="editor1"></textarea>
]]></text-property>
                    </text>
                </cell>
            </row>
        </grid>
    </body>
</report>
